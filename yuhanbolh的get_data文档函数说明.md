---
创建时间: 2024-01-14 16:12
tags:
  - 开源技术
  - yuhanbolh
备注: 
share: "true"
---



### 东财 api 获取日线数据
例子：
```python
import yuhanbolh as lh

lh.json_to_dfcf_qmt('000001.SZ', days=7*365, fqt=1)
# 通过类似000001.SZ的代码获取最新数据（东财api），参数3个，分别是：代码（必要），天数，复权类型
```

返回：
```python
time  open  close  high  ...  amplitude  percentage change  change amount  turnover rate
0     2017-01-16  7.80   7.79  7.81  ...       1.15              -0.26          -0.02           0.40
1     2017-01-17  7.77   7.80  7.81  ...       0.77               0.13           0.01           0.32
2     2017-01-18  7.79   7.82  7.84  ...       0.77               0.26           0.02           0.34
3     2017-01-19  7.80   7.83  7.89  ...       1.15               0.13           0.01           0.26  
4     2017-01-20  7.82   7.87  7.88  ...       0.77               0.51           0.04           0.23  
...          ...   ...    ...   ...  ...        ...                ...            ...            ...  
1696  2024-01-08  9.23   9.15  9.30  ...       2.05              -1.29          -0.12           0.58  
1697  2024-01-09  9.16   9.18  9.19  ...       1.09               0.33           0.03           0.39  
1698  2024-01-10  9.16   9.09  9.19  ...       1.09              -0.98          -0.09           0.44  
1699  2024-01-11  9.08   9.17  9.22  ...       2.09               0.88           0.08           0.48  
1700  2024-01-12  9.13   9.19  9.27  ...       1.74               0.22           0.02           0.40  

[1701 rows x 11 columns]
```

### 从 baostock 获取股票数据，含估值
例子：
```python
import yuhanbolh as lh
lh.query_stock_data("sh.600000", 180, 'd', '1')
# 从baostock获取股票数据，参数有4个：股票代码，周期，复权类型，指标列表
# adjustflag默认为d，日k线；d=日k线、w=周、m=月、5=5分钟、15=15分钟、30=30分钟、60=60分钟k线数据
# adjustflag复权类型：不复权：3；后复权：1；前复权：2
```

返回：
```python
	date       code           open           high  ...     peTTM     pbMRQ     psTTM  pcfNcfTTM
0    2023-07-19  sh.600000  84.1574121600  84.9578223300  ...  4.567976  0.361791  1.164975   3.480328
1    2023-07-20  sh.600000  84.9578223300  85.5295438800  ...  4.574141  0.362279  1.166547   3.485025
2    2023-07-21  sh.600000  84.8434806000  85.4409699000  ...  4.389203  0.347632  1.119382   3.344121
3    2023-07-24  sh.600000  84.6044848800  85.5604677600  ...  4.395367  0.348120  1.120954   3.348818
4    2023-07-25  sh.600000  85.7994634800  87.1139399400  ...  4.481672  0.354955  1.142964   3.414573
..          ...        ...            ...            ...  ...       ...       ...       ...        ...
117  2024-01-09  sh.600000  78.8685876000  79.3465790400  ...  5.014030  0.321752  1.091478  34.321226
118  2024-01-10  sh.600000  78.9880854600  79.2270811800  ...  4.983688  0.319805  1.084873  34.113533
119  2024-01-11  sh.600000  78.3905961600  78.7490897400  ...  4.953346  0.317858  1.078268  33.905840
120  2024-01-12  sh.600000  77.9126047200  78.3905961600  ...  4.930589  0.316398  1.073314  33.750071
121  2024-01-15  sh.600000  77.6736090000  78.1516004400  ...  4.938175  0.316885  1.074966  33.801994

```

注：该代码是对 baostock 中获取 k 线数据进行再封装，有兴趣的自行前往 baostock——[A股K线数据 - www.baostock.com](http://baostock.com/baostock/index.php/A%E8%82%A1K%E7%BA%BF%E6%95%B0%E6%8D%AE)

### 获取通达信数据
例子：
```python
import yuhanbolh as lh

```

返回：
```python
import yuhanbolh as lh
lh.get_financial_data('119.147.212.81', 7709, lambda api: api.get_transaction_data(0, '000001', 0, 30))
# 获取通达信的分笔成交数据，参数：服务器IP、服务器端口、函数
```

注：该代码是对 pytdx 的函数进行再封装，有兴趣的自行前往 pytdx —— [pytdx: Python通达信数据接口 (gitee.com)](https://gitee.com/better319/pytdx/#%E4%BF%9D%E5%AD%98%E6%96%87%E4%BB%B6)，其中包含其他数据的调用。

同时，该库提供交互，可以通过 `hqget` 进行交互

### 获取乌龟量化指数估值数据

例子：
```python
import yuhanbolh as lh

lh.turtle_quant_analysis()
# 获取乌龟量化的指数估值数据，没有参数
```

返回：
```python
序      代码      指数      价       涨 PE.市值加权  ...    北上加权   均市值 基金数     今年来    最大回撤       起始
0      1  931380    科技50   1981 -0.0142   24.92  ...  0.0554   872   4 -0.0688 -0.0807  2019.11     
1      2  931186    中证科技   4021 -0.0127   20.97  ...  0.0657   838   3 -0.0721 -0.0875  2019.05   
2      3  399006    创业板指   1761 -0.0091   25.99  ...  0.0552   361  74 -0.0603 -0.0783  2010.07   
3      4  931463  300ESG    916 -0.0032    9.86  ...  0.0398  1280   4 -0.0401 -0.0458  2020.05       
4      5  399673   创业板50   1650 -0.0116   23.41  ...  0.0687   554  15 -0.0613 -0.0809  2014.06    
..   ...     ...     ...    ...     ...     ...  ...     ...   ...  ..     ...     ...      ...       
227  228  H30007    芯片产业   1554 -0.0185   87.04  ...  0.0276   317  20 -0.0954 -0.1081  2016.01   
228  229     NDX   纳指100  16820  0.0017   35.20  ...       -     -  20 -0.0062 -0.0365  2012.01     
229  230  931775     房地产   2831 -0.0030  300.00  ...  0.0132   115   5 -0.0382 -0.0485  2013.07    
230  231  399983    地产等权   2560 -0.0065   15.97  ...  0.0193   540   3 -0.0587 -0.0689  2013.11   
231  232  935600  MSCI印度    939  0.0115   36.04  ...       -     -   3  0.0048 -0.0080  2009.09     

[232 rows x 15 columns]
```

### 通过 akshare 指数估值数据
例子：
```python
import yuhanbolh as lh

lh.akshare_index_analysis()
# 获取akshare指数估值数据，没有参数
```

返回：
```python
指数名称    最新PE   PE分位   最新PB   PB分位   股息率  股息率分位        指数代码      指数开始时间        更新时间
0        创新100   30.09   0.09   3.26   0.00  1.31  99.47  931159.CSI  2019-05-16  2024-01-12
1         创业板指   25.99   0.12   3.52   2.76  1.01  99.84   399006.SZ  2010-06-01  2024-01-12
2        创业板50   23.41   0.13   3.88   4.31  1.00  99.78   399673.SZ  2014-06-18  2024-01-12
3         中证高装   21.77   0.14   2.33   9.02  1.44  99.82  930599.CSI  2015-03-02  2024-01-12
4      SHS消费龙头   21.40   0.14   4.61  43.73  2.77  99.03  931663.CSI  2015-03-13  2024-01-12
..         ...     ...    ...    ...    ...   ...    ...         ...         ...         ...
268      猪产业指数   79.26  96.77   3.14  11.05  1.98  71.48   884251.WI  2015-12-31  2023-10-27
269    中证全指房地产  407.29  97.39   0.69   0.08  2.40  52.31  931775.CSI  2013-07-15  2024-01-12
270      鸡产业指数  109.83  99.28   2.85  29.01  0.98  24.35   884252.WI  2015-12-31  2024-01-12
271  标普500信息技术   39.44  99.55  11.04  94.64  0.76   0.57  S5INFT.SPI  1996-06-28  2024-01-12
272    费城半导体指数   41.49  99.86   7.61  81.14  0.91   0.35      SOX.GI         NaT  2024-01-12

[273 rows x 10 columns]
```

注：该代码是对 akshare 中获取指数估值的再封装，有兴趣的自行前往 akshare——[Welcome to AKShare’s Online Documentation! — AKShare 1.12.23 文档 (akfamily.xyz)](https://akshare.akfamily.xyz/)

### 通可 akshare 获取集思录可转债数据
例子：
```python
import yuhanbolh as lh

lh.akshare_convertible_bond()
# 获取集思录可转债数据，没有参数
```

返回：
```python
         代码    名称  ...                                               强赎条款   强赎状态
0    110061  川投转债  ...  在转股期内，如果公司股票在任何连续三十个交易日中至少有十五个交易日的收盘价格不低于当期转股价...  已公告强赎
1    128034  江银转债  ...  在本次发行可转债的转股期内,如果公司A股股票连续三十个交易日中至少有十五个交易日的收盘价格不...  已公告强赎
2    110043  无锡转债  ...  在本次发行可转债的转股期内，如果发行人 A 股股票连续三十个交易日中至少有十 五个交易日的收盘...  已公告强赎
3    128035  大族转债  ...  在本次发行的可转债转股期内，如果公司A股股票连续三十个交易日中至少有十五个 交易日的收盘价格不...  已公告强赎
4    113027  华钰转债  ...  如果公司A股股票连续三十个交易日中至少有十五个交易日的收盘价格不低于当期转 股价格的130%(...
..      ...   ...  ...                                                ...    ...
551  123127  耐普转债  ...  如果公司股票连续三十个交易日中至少有十五个交易日的收盘价不低于当期转股价格的 130%(含 ...  公告不强赎
552  123013  横河转债  ...  在本次发行的可转债转股期内，如果公司 A 股股票连续三十个交易日中至少有十五 个交易日的收盘价...  公告不强赎
553  110083  苏租转债  ...  如果公司 A 股股票连续三十个交易日中至 少有十五个交易日的收盘价格不低于当期转股价格的13...  公告不强赎
554  113648  巨星转债  ...  如果公司股票在任意连续三十个交易日中至少有十五个交易日的收盘价格不低于当期转股价格的 130...  公告不强赎
555  123236  家联转债  ...  如果公司股票在任意连续三十个交易日中至少十五个交易日的收盘价格不低于当期转股价格的 130%...

[556 rows x 16 columns]
```

注：该代码是对 akshare 中获取集思录可转债的再封装，有兴趣的自行前往 akshare—— [Welcome to AKShare’s Online Documentation! — AKShare 1.12.23 文档 (akfamily.xyz)](https://akshare.akfamily.xyz/)
### 通过 pywencai 获取问财数据
例子：
```python
import yuhanbolh as lh

lh.get_pywencai('可转债；期权价值；最新价<100','conbond', True)
# 通过pywencai模块获取问财数据，参数为：问题和查询类型，以及是否循环分页。
```

返回：
```python
可转债@可转债代码 可转债@可转债简称 可转债@最新价  ...  可转债@最新余额变动原因[20240112] market_code    code
0  118022.SH      锂科转债  99.727  ...                    转债转股          19  118022
1  127061.SZ      美锦转债  99.670  ...                    转债转股          35  127061
2  127019.SZ      国城转债  99.490  ...                    转债转股          35  127019
3  113596.SH      城地转债  98.260  ...                    转债转股          19  113596
4  110072.SH      广汇转债  91.418  ...                    转债转股          19  110072
5  127047.SZ      帝欧转债  85.085  ...                    转债转股          35  127047
6  404001.NQ      蓝盾退债  69.450  ...                      其他         147  404001
7  128085.SZ      鸿达转债  40.798  ...                    转债转股          35  128085
8  404002.NQ      搜特退债  23.080  ...                    转债转股         147  404002

[9 rows x 22 columns]
```

注：由于程序中执行了 js 代码，请先保证已安装了 [Node.js](https://nodejs.org/en/)，需要版本**v16+**。该代码是对 akshare 中获取指数估值的再封装，有兴趣的自行前往 github 的 pywenci—— [zsrl/pywencai: 获取同花顺问财数据 (github.com)](https://github.com/zsrl/pywencai)

### 获取价值大师网的大师价值
例子：
```python
import yuhanbolh as lh

lh.get_valuation_ratios('000001')
# 获取价值大师网的大师价值数据，参数为：股票代码
```

返回：
```python
   名称   大师价值    现价
0  平安银行  17.75  9.19
```


### 获取 mt5 行情数据
例子：
```python
import yuhanbolh as lh
lh.get_mt5_data('XAUUSD', timeframe=mt5.TIMEFRAME_D1, days_back=10)
# 获取价值大师网的大师价值数据，参数为：股票代码
```

返回：
```python
	time     open     high      low    close  volume  spread  real_volume
0 2024-01-08  2045.16  2046.64  2016.84  2028.18   87442       0            0
1 2024-01-09  2028.19  2041.94  2026.14  2030.21   81864       0            0
2 2024-01-10  2030.29  2040.09  2020.47  2024.32   80865       0            0
3 2024-01-11  2024.38  2042.43  2013.36  2028.54   90636       0            0
4 2024-01-12  2028.77  2062.24  2028.73  2048.81   87257       0            0
5 2024-01-15  2048.19  2058.10  2045.80  2055.60   24098       0            0

```



